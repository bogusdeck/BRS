{% extends "base.html" %} {% load static %} {% block title %}Home{% endblock %}
{% block content %}
<div>
  <!-- Search Bar Section -->
  <section class="mb-12">
    <div
      class="flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-cyan-100 via-pink-200 to-yellow-200 rounded-lg shadow-lg"
    >
      <div
        class="text-3xl md:text-4xl lg:text-5xl text-center font-semibold mb-6 px-4"
      >
        Find the book<br />that matches your preferences
      </div>
      <form method="get" action="{% url 'showcase' %}" class="">
      <div
        class="flex items-center max-w-lg mx-5 sm:mx-3 md:mx-0 bg-white rounded-full shadow-lg"
      >
        <input
          type="search" name="query"
          class="w-full px-4 py-2 text-gray-800 rounded-l-full focus:outline-none"
          placeholder="Search for books..."
        />
        <button
          type="submit"
          class="bg-[#01cccd] text-white rounded-r-full w-12 h-12 flex items-center justify-center hover:bg-teal-700"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
            ></path>
          </svg>
        </button>
        </form
      </div>
    </div>
  </section>

  <!-- Trending Books Carousel -->
  <h2 class="text-3xl font-bold text-teal-600 mb-6 text-center">
    Trending Books
  </h2>
  <div class="swiper-container mb-12">
    <div class="swiper-wrapper">
      {% for book in trending_books %}
      <div
        class="swiper-slide flex flex-col bg-white shadow-md rounded-lg overflow-hidden transform transition duration-300 hover:shadow-lg hover:scale-105"
      >
        <img
          class="w-full h-52 object-contain"
          src="{{ book.volumeInfo.imageLinks.thumbnail|default:'/static/default_for_cover.jpg' }}"
          alt="{{ book.volumeInfo.title }}"
        />
        <div class="flex-grow p-4">
          <h3 class="text-base font-semibold text-gray-800 truncate">
            {{ book.volumeInfo.title }}
          </h3>
          <p class="text-gray-600 text-xs mt-2 truncate">
            {{ book.volumeInfo.authors|join:", " }}
          </p>
          <br />
        </div>
        <div
          class="absolute bottom-0 right-0 bg-teal-600 text-white text-xs font-bold px-2 py-1 rounded-tl-lg"
        >
          {% if book.volumeInfo.averageRating %} ★ {{
          book.volumeInfo.averageRating }} {% else %} ★ ? {% endif %}
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Swiper Pagination and Navigation -->
    <div class="swiper-pagination"></div>
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
  </div>

  <!-- All-Time Favorites Section -->
  <h2 class="text-3xl font-bold text-teal-600 mb-6 text-center">
    All-Time Favorites
  </h2>
  <div
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 mb-12 mx-5"
  >
    {% for book in all_time_favorites %}
    <div
      class="book bg-white shadow-md rounded-lg overflow-hidden relative transform transition duration-300 hover:shadow-lg hover:scale-105"
    >
      <img
        class="w-full h-52 object-contain"
        src="{{ book.volumeInfo.imageLinks.thumbnail|default:'/static/default_for_cover.jpg' }}"
        alt="{{ book.volumeInfo.title }}"
      />
      <div class="flex-grow p-4">
        <h3 class="text-base font-semibold text-gray-800 truncate">
          {{ book.volumeInfo.title }}
        </h3>
        <p class="text-gray-600 text-xs mt-2 truncate">
          {{ book.volumeInfo.authors|join:", " }}
        </p>
        <br />
      </div>
      <div
        class="absolute bottom-0 right-0 bg-teal-600 text-white text-xs font-bold px-2 py-1 rounded-tl-lg"
      >
        {% if book.volumeInfo.averageRating %} ★ {{
        book.volumeInfo.averageRating }} {% else %} ★ ? {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Recommended for You Section -->
  <h2
    class="text-3xl font-bold text-teal-600 mb-6 text-center flex items-center"
  >
    <span class="flex-grow text-center">Recommended for You</span>
  </h2>
  <div class="flex flex-col items-center justify-center text-center mb-6">
    <p
      class="text-lg font-semibold text-gray-300 mb-2 flex items-center justify-center"
    >
      Your Preferences:
      <a href="{% url 'preference' %}"
        ><img
          src="{% static 'edit.png' %}"
          alt="Edit Preferences"
          class="w-6 h-6 ml-2 cursor-pointer hover:opacity-75"
        />
      </a>
    </p>
    <div class="border-2 h-auto border-white w-fit flex flex-wrap mb-4 p-2">
      <p class="text-white">{{ user.preference|join:", " }}</p>
    </div>
  </div>

  {% if user_recommendations %}
  <div
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 mb-12 mx-5"
  >
    {% for book in user_recommendations %}
    <div
      class="book bg-white shadow-md rounded-lg overflow-hidden relative transform transition duration-300 hover:shadow-lg hover:scale-105"
    >
      <img
        class="w-full h-52 object-contain"
        src="{{ book.volumeInfo.imageLinks.thumbnail|default:'/static/default_for_cover.jpg' }}"
        alt="{{ book.volumeInfo.title }}"
      />
      <div class="flex-grow p-4">
        <h3 class="text-base font-semibold text-gray-800 truncate">
          {{ book.volumeInfo.title }}
        </h3>
        <p class="text-gray-600 text-xs mt-2 truncate">
          {{ book.volumeInfo.authors|join:", " }}
        </p>
        <br />
      </div>
      <div
        class="absolute bottom-0 right-0 bg-teal-600 text-white text-xs font-bold px-2 py-1 rounded-tl-lg"
      >
        {% if book.volumeInfo.averageRating %} ★
        {{book.volumeInfo.averageRating}} {% else %} ★ ? {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div
    class="text-center text-lg font-semibold text-gray-600 mb-12 flex flex-col items-center justify-center gap-4"
  >
    Add some of your preferences first to get recommendations
    <a
      href="{% url 'preference' %}"
      class="flex text-black bg-white px-2 py-1 rounded-xl"
      >Edit<img
        src="{% static 'edit.png' %}"
        alt="Edit Preferences"
        class="w-6 h-6 ml-2 cursor-pointer hover:opacity-75"
      />
    </a>
  </div>
  {% endif %}

  <!-- Books Recommended by Other Users Section -->
  <h2 class="text-3xl font-bold text-teal-600 mb-6 text-center">
    Recommended by Other Users
  </h2>
  <div
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-8 mb-12 mx-5"
  >
    {% for book in other_user_recommendations %}
    <div
      class="book bg-white shadow-md rounded-lg overflow-hidden relative transform transition duration-300 hover:shadow-lg hover:scale-105"
    >
      <img
        class="w-full h-52 object-contain"
        src="{{ book.volumeInfo.imageLinks.thumbnail|default:'/static/default_for_cover.jpg' }}"
        alt="{{ book.volumeInfo.title }}"
      />
      <div class="flex-grow p-4">
        <h3 class="text-base font-semibold text-gray-800 truncate">
          {{ book.volumeInfo.title }}
        </h3>
        <p class="text-gray-600 text-xs mt-2 truncate">
          {{ book.volumeInfo.authors|join:", " }}
        </p>
        <br />
      </div>
      <div
        class="absolute bottom-0 right-0 bg-teal-600 text-white text-xs font-bold px-2 py-1 rounded-tl-lg"
      >
        {% if book.volumeInfo.averageRating %} ★ {{
        book.volumeInfo.averageRating }} {% else %} ★ ? {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>

  <script>
    var swiper = new Swiper(".swiper-container", {
      slidesPerView: 1,
      spaceBetween: 10,
      loop: true,
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      breakpoints: {
        640: {
          slidesPerView: 2,
          spaceBetween: 20,
        },
        768: {
          slidesPerView: 3,
          spaceBetween: 30,
        },
        1024: {
          slidesPerView: 4,
          spaceBetween: 40,
        },
      },
    });
  </script>
</div>
{% endblock %}
